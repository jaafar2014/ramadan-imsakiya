<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ø¥Ù…Ø³Ø§ÙƒÙŠØ© Ø±Ù…Ø¶Ø§Ù† Ø§Ù„Ø°ÙƒÙŠØ©</title>

<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">

<!-- PWA -->
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#6a3ccf">

<script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>

<style>
body{
  margin:0;
  font-family:'Cairo',sans-serif;
  background:#1b0f33;
  color:#fff;
}
.container{max-width:430px;margin:auto}

/* ===== Menu ===== */
.menu-btn{
  position:fixed;
  top:15px;
  right:15px;
  font-size:26px;
  cursor:pointer;
  z-index:10;
}

/* ===== Drawer ===== */
.drawer{
  position:fixed;
  top:0;
  right:-100%;
  width:100%;
  height:100%;
  background:#6a3ccf;
  z-index:999;
  transition:.3s;
}
.drawer.active{right:0}
.drawer-content{padding:20px}
.close-btn{font-size:22px;cursor:pointer}

/* ===== Header ===== */
.header-bg{
  background:linear-gradient(180deg,#ff4fa1,#7b3cff,#1b0f33);
  padding:30px 20px 80px;
  text-align:center;
  position:relative;
}
.profile{
  position:absolute;
  left:50%;
  bottom:-55px;
  transform:translateX(-50%);
}
.profile img{
  width:110px;
  height:110px;
  border-radius:50%;
  object-fit:cover;
  background:#ccc;
}

/* ===== Memorial ===== */
.memorial{
  margin-top:70px;
  text-align:center;
}
.memorial small{opacity:.85}
.memorial strong{
  display:block;
  color:#ff4d4d;
  font-size:20px;
  margin-top:6px;
}

/* ===== Day ===== */
.ramadan-day{
  text-align:center;
  font-size:22px;
  font-weight:700;
  color:#ffb703;
  margin:15px 0;
}

/* ===== Cards ===== */
.card{
  background:#4c2db3;
  border-radius:18px;
  padding:15px;
  margin:15px;
}
.times{
  display:grid;
  grid-template-columns:repeat(3,1fr);
  gap:10px;
}
.time-box{
  background:#000;
  border-radius:12px;
  padding:10px;
  text-align:center;
}
.time-box span{font-size:12px;opacity:.7}
.time-box strong{color:#ffb703}

.countdown{
  margin-top:12px;
  background:#ffb703;
  color:#000;
  border-radius:14px;
  padding:10px;
  text-align:center;
  font-weight:700;
}

/* ===== Calendar ===== */
.calendar{
  display:grid;
  grid-template-columns:repeat(5,1fr);
  gap:8px;
  padding:15px;
}
.day{
  background:#5a3fc0;
  border-radius:12px;
  padding:10px 0;
  text-align:center;
  cursor:pointer;
}
.day.active{background:#ff9f6e;color:#000;font-weight:700}

/* ===== Dua ===== */
.dua{
  margin-top:20px;
  background:#5a3fc0;
  padding:15px;
  border-radius:14px;
  font-size:14px;
  text-align:center;
}
.dua span{color:#ffb703;font-weight:700}

/* ===== Buttons ===== */
button{
  width:100%;
  padding:12px;
  border:none;
  border-radius:14px;
  margin-top:10px;
  font-family:'Cairo';
  font-size:15px;
  cursor:pointer;
}
.save-btn{background:#ff4d4d;color:#fff}
.install-btn{background:#ffb703;color:#000;display:none}
</style>
</head>

<body>

<div class="menu-btn" onclick="toggleDrawer()">â˜°</div>

<!-- Drawer -->
<div class="drawer" id="drawer">
  <div class="drawer-content">
    <div class="close-btn" onclick="toggleDrawer()">âœ•</div>

    <h3>Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</h3>

    <select id="city">
      <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø©</option>
      <option value="Baghdad">Ø¨ØºØ¯Ø§Ø¯</option>
      <option value="Basrah">Ø§Ù„Ø¨ØµØ±Ø©</option>
      <option value="Najaf">Ø§Ù„Ù†Ø¬Ù</option>
      <option value="Karbala">ÙƒØ±Ø¨Ù„Ø§Ø¡</option>
    </select>

    <select id="sect">
      <option value="4">Ø§Ù„ÙˆÙ‚Ù Ø§Ù„Ø³Ù†ÙŠ</option>
      <option value="0">Ø§Ù„ÙˆÙ‚Ù Ø§Ù„Ø´ÙŠØ¹ÙŠ</option>
    </select>

    <div class="dua">
      <span id="duaTitle"></span><br>
      <div id="duaText"></div>
    </div>

    <button class="save-btn" onclick="saveImage()">ğŸ“¸ Ø­ÙØ¸ ØµÙˆØ±Ø© Ø§Ù„ÙŠÙˆÙ…</button>
  </div>
</div>

<div id="captureArea" class="container">

  <div class="header-bg">
    <div class="profile">
      <img src="photo.jpg">
    </div>
  </div>

  <div class="memorial">
    <small>Ø§Ù„ÙØ§ØªØ­Ø© Ø¹Ù„Ù‰ Ø±ÙˆØ­ Ø§Ù„Ø´Ù‡ÙŠØ¯</small>
    <strong>Ø§Ù„Ù…Ø±Ø­ÙˆÙ… Ø£Ù…Ø§Ù† Ø¹Ø¨Ø¯Ø§Ù„Ø¬Ø¨Ø§Ø± Ø¹Ø¨Ø¯Ø§Ù„Ø±Ø¶Ø§</strong>
  </div>

  <div class="ramadan-day" id="ramadanDay">1 Ø±Ù…Ø¶Ø§Ù†</div>

  <div class="card">
    <div class="times">
      <div class="time-box"><span>Ø§Ù„ÙØ¬Ø±</span><strong id="fajr">--</strong></div>
      <div class="time-box"><span>Ø§Ù„Ø¸Ù‡Ø±</span><strong id="dhuhr">--</strong></div>
      <div class="time-box"><span>Ø§Ù„Ù…ØºØ±Ø¨</span><strong id="maghrib">--</strong></div>
    </div>
    <div class="countdown" id="countdown">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø©</div>
  </div>

  <div class="calendar" id="calendar"></div>

</div>

<button class="install-btn" id="installBtn">â• ØªØ«Ø¨ÙŠØª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚</button>

<script>
/* ===== Dua ===== */
const duas=[
"Ø§Ù„Ù„Ù‡Ù… Ø§Ø¬Ø¹Ù„ ØµÙŠØ§Ù…ÙŠ ÙÙŠÙ‡ ØµÙŠØ§Ù… Ø§Ù„ØµØ§Ø¦Ù…ÙŠÙ†",
"Ø§Ù„Ù„Ù‡Ù… Ù‚Ø±Ø¨Ù†ÙŠ ÙÙŠÙ‡ Ø¥Ù„Ù‰ Ù…Ø±Ø¶Ø§ØªÙƒ",
"Ø§Ù„Ù„Ù‡Ù… Ø§Ø±Ø²Ù‚Ù†ÙŠ ÙÙŠÙ‡ Ø±Ø­Ù…Ø© Ø§Ù„Ø£ÙŠØªØ§Ù…",
"Ø§Ù„Ù„Ù‡Ù… Ø·Ù‡Ø±Ù†ÙŠ ÙÙŠÙ‡ Ù…Ù† Ø§Ù„Ø¯Ù†Ø³",
"Ø§Ù„Ù„Ù‡Ù… Ø§Ø¬Ø¹Ù„Ù†ÙŠ ÙÙŠÙ‡ Ù…Ù† Ø§Ù„Ù…ØªÙˆÙƒÙ„ÙŠÙ†",
"Ø§Ù„Ù„Ù‡Ù… Ø§Ø±Ø²Ù‚Ù†ÙŠ ÙÙŠÙ‡ Ø­Ø³Ù† Ø§Ù„ØªÙˆÙƒÙ„",
"Ø§Ù„Ù„Ù‡Ù… Ù„Ø§ ØªØ®Ø°Ù„Ù†ÙŠ ÙÙŠÙ‡",
"Ø§Ù„Ù„Ù‡Ù… ÙˆÙÙ‚Ù†ÙŠ ÙÙŠÙ‡ Ù„Ø·Ø§Ø¹ØªÙƒ",
"Ø§Ù„Ù„Ù‡Ù… Ø§Ø¬Ø¹Ù„Ù†ÙŠ ÙÙŠÙ‡ Ù…Ù† Ø§Ù„Ù…Ø³ØªØºÙØ±ÙŠÙ†",
"Ø§Ù„Ù„Ù‡Ù… Ø§ÙØªØ­ Ù„ÙŠ ÙÙŠÙ‡ Ø£Ø¨ÙˆØ§Ø¨ ÙØ¶Ù„Ùƒ",
"Ø§Ù„Ù„Ù‡Ù… Ø§Ø¬Ø¹Ù„Ù†ÙŠ ÙÙŠÙ‡ Ù…Ù† Ø§Ù„Ù…ØªÙ‚ÙŠÙ†",
"Ø§Ù„Ù„Ù‡Ù… Ø²ÙŠÙ†ÙŠ ÙÙŠÙ‡ Ø¨Ø§Ù„Ø³ØªØ± ÙˆØ§Ù„Ø¹ÙØ§Ù",
"Ø§Ù„Ù„Ù‡Ù… Ø·Ù‡Ø± Ù‚Ù„Ø¨ÙŠ Ù…Ù† Ø§Ù„Ø¸Ù„Ù…Ø§Øª",
"Ø§Ù„Ù„Ù‡Ù… Ø§Ø±Ø²Ù‚Ù†ÙŠ ÙÙŠÙ‡ Ø§Ù„Ø®Ø´ÙˆØ¹",
"Ø§Ù„Ù„Ù‡Ù… Ø§Ø¬Ø¹Ù„Ù†ÙŠ ÙÙŠÙ‡ Ù…Ù† Ø§Ù„Ù…Ù‚Ø¨ÙˆÙ„ÙŠÙ†",
"Ø§Ù„Ù„Ù‡Ù… ÙˆÙÙ‚Ù†ÙŠ ÙÙŠÙ‡ Ù„Ù‚ÙŠØ§Ù… Ø§Ù„Ù„ÙŠÙ„",
"Ø§Ù„Ù„Ù‡Ù… Ø§Ø±Ø­Ù… Ø¶Ø¹ÙÙŠ",
"Ø§Ù„Ù„Ù‡Ù… Ø§ØºÙØ± Ù„ÙŠ ÙˆÙ„ÙˆØ§Ù„Ø¯ÙŠ",
"Ø§Ù„Ù„Ù‡Ù… ØªÙ‚Ø¨Ù„ ØµÙŠØ§Ù…ÙŠ",
"Ø§Ù„Ù„Ù‡Ù… Ø§Ø¬Ø¹Ù„Ù†ÙŠ Ù…Ù† Ø¹ØªÙ‚Ø§Ø¦Ùƒ",
"Ø§Ù„Ù„Ù‡Ù… Ø§Ø±Ø²Ù‚Ù†ÙŠ Ø­Ø³Ù† Ø§Ù„Ø®Ø§ØªÙ…Ø©",
"Ø§Ù„Ù„Ù‡Ù… Ù‚Ø±Ø¨Ù†ÙŠ Ø¥Ù„ÙŠÙƒ",
"Ø§Ù„Ù„Ù‡Ù… Ù„Ø§ ØªØ­Ø±Ù…Ù†ÙŠ ÙØ¶Ù„Ùƒ",
"Ø§Ù„Ù„Ù‡Ù… Ø§Ø¬Ø¹Ù„ Ø¹Ù…Ù„ÙŠ Ø®Ø§Ù„ØµÙ‹Ø§",
"Ø§Ù„Ù„Ù‡Ù… Ø§Ø±Ø²Ù‚Ù†ÙŠ Ø±Ø¶Ø§Ùƒ",
"Ø§Ù„Ù„Ù‡Ù… Ø§ÙƒØªØ¨Ù†ÙŠ Ù…Ù† Ø§Ù„Ù…Ù‚Ø¨ÙˆÙ„ÙŠÙ†",
"Ø§Ù„Ù„Ù‡Ù… Ø§Ø¬Ø¹Ù„ Ù‡Ø°Ø§ Ø§Ù„Ø´Ù‡Ø± ÙØ±Ø¬Ù‹Ø§",
"Ø§Ù„Ù„Ù‡Ù… Ø§Ø®ØªÙ… Ù„Ù†Ø§ Ø¨Ø§Ù„Ù…ØºÙØ±Ø©",
"Ø§Ù„Ù„Ù‡Ù… ØªÙ‚Ø¨Ù„ Ù…Ù†Ø§",
"Ø§Ù„Ù„Ù‡Ù… Ø¨Ù„ØºÙ†Ø§ Ù„ÙŠÙ„Ø© Ø§Ù„Ù‚Ø¯Ø±"
];

let selectedDay=1;
let maghribTime=null;

function updateDua(){
  document.getElementById('ramadanDay').innerText=selectedDay+" Ø±Ù…Ø¶Ø§Ù†";
  document.getElementById('duaTitle').innerText="Ø¯Ø¹Ø§Ø¡ Ø§Ù„ÙŠÙˆÙ… "+selectedDay;
  document.getElementById('duaText').innerText=duas[selectedDay-1];
}
updateDua();

/* ===== Calendar ===== */
const calendar=document.getElementById('calendar');
for(let i=1;i<=30;i++){
  const d=document.createElement('div');
  d.className='day'+(i===1?' active':'');
  d.innerText='Ø±Ù…Ø¶Ø§Ù† '+i;
  d.onclick=()=>{
    document.querySelectorAll('.day').forEach(x=>x.classList.remove('active'));
    d.classList.add('active');
    selectedDay=i;
    updateDua();
    loadTimes();
  };
  calendar.appendChild(d);
}

/* ===== Times ===== */
function loadTimes(){
  const city=document.getElementById('city').value;
  const sect=document.getElementById('sect').value;
  if(!city) return;

  const date=new Date(2026,1,17+selectedDay);
  const d=date.getDate(),m=date.getMonth()+1,y=date.getFullYear();

  fetch(`https://api.aladhan.com/v1/timingsByCity/${d}-${m}-${y}?city=${city}&country=Iraq&method=${sect}`)
  .then(res=>res.json())
  .then(data=>{
    const t=data.data.timings;
    fajr.innerText=t.Fajr;
    dhuhr.innerText=t.Dhuhr;
    maghrib.innerText=t.Maghrib;
    const [h,min]=t.Maghrib.split(':');
    maghribTime=new Date(y,m-1,d,h,min);
  });
}
setInterval(()=>{
  if(!maghribTime) return;
  const diff=maghribTime-new Date();
  if(diff<=0){
    countdown.innerText="ğŸŒ™ Ø­Ø§Ù† ÙˆÙ‚Øª Ø§Ù„Ø¥ÙØ·Ø§Ø±";
    return;
  }
  const h=Math.floor(diff/3600000);
  const m=Math.floor((diff%3600000)/60000);
  const s=Math.floor((diff%60000)/1000);
  countdown.innerText=`Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ Ù„Ù„Ø¥ÙØ·Ø§Ø± ${h}:${m}:${s}`;
},1000);

/* ===== Save Image ===== */
function saveImage(){
  html2canvas(document.getElementById('captureArea')).then(canvas=>{
    const link=document.createElement('a');
    link.download=`Ø±Ù…Ø¶Ø§Ù†_${selectedDay}.png`;
    link.href=canvas.toDataURL();
    link.click();
  });
}

/* ===== Drawer ===== */
function toggleDrawer(){
  document.getElementById('drawer').classList.toggle('active');
}

/* ===== PWA ===== */
let deferredPrompt;
window.addEventListener('beforeinstallprompt',e=>{
  e.preventDefault();
  deferredPrompt=e;
  document.getElementById('installBtn').style.display='block';
});
document.getElementById('installBtn').onclick=()=>{
  deferredPrompt.prompt();
};
</script>

</body>
</html>
